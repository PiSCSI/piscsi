-------------------------------------------------- ----------------------------

 SCSI Target Emulator RaSCSI (*^..^*)
 for Raspberry Pi

 Copyright (C) 2016-2020 GIMONS
 translated using google translate by akuker
 modified by mmmattera
-------------------------------------------------- ----------------------------
□ What is RaSCSI
  RaSCSI is a SCSI device (hard disk, MO, CD-ROM, ethernet) that operates on the Raspberry Pi.
  It emulates these devices using a Raspberry Pi. Originally developed for the SHARP X68000 gaming system.
  Simply connect it to a SCSI port and it will be recognized as a physical SCSI device.
  The RaSCSI also works with FM TOWNS and PC9821Ce and Apple Mac SCSI machines.
  
  Refers to the general term for the mechanism that converts a GPIO connector into a SCSI connector.

□ Compatible RaSCSI boards with GPIO frequency test results
    Raspberry Pi A                         1.301 khz
    Raspberry Pi Zero                      1.702 khz
    Raspberry Pi Zero W                    1.752 khz
    Raspberry Pi Zero WH                   ?.??? khz
    Raspberry Pi 2 Model B                 8.307 khz
    Raspberry Pi 3 Model B (recommended)  13.51  khz
    Raspberry Pi 3 Model A+               16.02  khz
    Raspberry Pi 3 Model B+               16.11  khz
    Raspberry Pi 4 Model B                50.84  khz

    Performance may be a little unstable with slower models.

    Model 3 and 4 boards are high performance but are affected by heat,
    so it may be necessary to add heat sinks, fans or take other measures.

  (2) Raspbian OS
    RaSCSI uses GPIO to control SCSI signals therefore a character user interface
    or web server is recommended to keep latency as low as possible. As opposed to
    a GUI that uses greater resources of the board.

□ Connection method with SCSI connector
  There are a multitude of ways to connect this board so information is contained
  in the WIKI.

□ Handout
  The original source tree structure follows. See the WIKI for additional information.

  bin/ ･･･ Executable file
    raspberrypi/ ･･･ RPI program
       rascsi.tar.gz ･･･ The tar+gzip of the executable file.

    x68k/ ･･･ Dedicated driver for X68000
       RASDRIVER.XDF... A floppy image containing two drivers
       RASDRIVER.HDS... A SCSI HD image containing two drivers
       RASDRIVER.HDF... SASI HD image containing two drivers

  doc/ ･･･Documents
    rascsi.txt ･･･ This document
    x68k.txt ･･･ Description of X68000 specific functions
    converter.txt ･･･ Description of converter board
    pinassign.png ･･･ Pin assignment diagram
    target.png ･･･ Conversion board circuit pattern (target mode)
    fullspec.png ･･･Conversion board circuit pattern (full spec)

  src/ ･･･ Source code
    raspberrypi/ ･･･ Set of program source for RPI
    x68k/ ･･･ Set of programs for X68000

  The driver for X68000 includes the following two in RASDRIVER.XDF or RASDRIVER.HDS
  It is
    RASDRV.SYS ･･･ Host drive driver
    RASETHER.SYS ･･･ Ethernet driver

□ How to use RASCI main unit (rascsi)

  ID is specified by:
   rascsi [-IDn FILE] ...
    where n is from 0 - 7

  When specifying HD (compatible with HD specification of X68000 SASI machine)
   rascsi [-HDn FILE] ...
    n: 0 - 15

  Root privledges are required to run the rascsi server.
  The -h option displays the help info.

  Usage: rascsi [-IDn FILE] ...

   n is SCSI identification number(0-7).
   FILE is disk image file.

  Usage: rascsi [-HDn FILE] ...

   n is X68000 SASI HD number(0-15).
   FILE is disk image file.

   Image type is detected based on file extension.
    hdf: SASI HD image(XM6 SASI HD image)
    hds: SCSI HD image(XM6 SCSI HD image)
    hdn: SCSI HD image (NEC GENUINE)
    hdi: SCSI HD image(Anex86 HD image)
    nhd: SCSI HD image(T98Next HD image)
    hda: SCSI HD image(APPLE GENUINE)
    mos: SCSI MO image(XM6 SCSI MO image)
    iso: SCSI CD image (ISO 9660 image)

  A SCSI (SASI) device can be specified by using -IDn or -HDn and FILENAME.
  -The number after the ID is the SCSI (SASI) ID. You can specify 0-7 as the ID, 
  but usually the PC controller uses ID7 as the initiator. In that case, you must 
  specify a value from 0-6 to prevent a collision.

  FILE is the file path of the virtual disk image. The image file name has an extension
  Is required. The type of HD, MO, CD is determined by the extension.

  Example) When you specify HDIMAGE0.HDS for SCSI ID0 and HDIMAGE1.HDS for ID1 and start up,
    sudo rascsi -ID0 HDIMAGE0.HDS -ID1 HDIMAGE1.HDS

  When you finish, press CTRL+C to stop.
  If it is started in the background, use the kill -HUP or kill -9 to the relevant process

  After starting, rascsi server opens a socket (6868 port) and waits for management commands.

□ How to use the management tool (rasctl)
  The management tool is called rasctl. It communicates with the rascsi process.
  It spawns a server that runs in the background and waits for connections on port 6868.
  
  Use rasctl to issue operation commands as follows:

    rasctl -i ID [-u UNIT] [-c CMD] [-t TYPE] [-f FILE]

      ID: SCSI ID (0 to 7)
      UNIT: Unit number (0 or 1)
      CMD: Operation command
             attach: attach disk
             detach: detach disk
             insert: insert media (MO or CD only)
             eject: Eject media (MO or CD only)
             protect: Write protect the media (MO only)
      TYPE: Disc type one of,
             hd: Hard disk (SASI/SCSI)
             mo: MO (magneto-optical disk)
             cd: CDROM (CDROM drive)
             bridge: Bridge device
      FILE: Path of disk image file

  ID is required. UNIT defaults to 0 (default is 0 for SCSI).
  CMD defaults to "attach" when omitted. By default TYPE is taken from the file extension
  if present, otherwise it must be specified.
  CMD and TYPE are case insensitive. Only the first letter of CMD is used.

  Command example
    rasctl -i 0 -f HDIMAGE0.HDS

  Is 0, the SCSI ID is 0. CMD is attach by default and TYPE is determined from the extension HDS
  as "hd".

  If only -l option is specified to check the current status, the device list is displayed.

    rasctl -l

  You do not need root privileges to start rasctl.

□ How to use Disk Dump Tool (rasdump)

  As the name suggests, it dumps (optionally restores) the image of SCSI HDD or MO.
  Specify your own ID as BID. If omitted, 7 is used.

    rasdump -i ID [-b BID] -f FILE [-r]
     ID: SCSI ID of the target device
     BID: RaSCSI's own SCSI ID
     FILE: dump file name
     -r: Restore mode

□ How to use SASI dedicated disk dump tool (sasidump)
  A dump tool created for SASI based on rasdump.
  Dump (optionally restore) the SASI HD image.

    sasidump -i ID [-u UT] [-b BSIZE] -c COUNT -f FILE [-r]
     ID: SASI ID of the target device
     UT: UNIT ID of the target device
     BSIZE: Block size (default 512)
     COUNT: Number of blocks
     FILE: dump file name
     -r: Restore mode

□ Compiling the executable file from the source
   Standard edition
     make CONNECT_TYPE=STANDARD

   Full spec version
     make CONNECT_TYPE=FULLSPEC

   Aibomu version
     make CONNECT_TYPE=AIBOM

   GAMERnium version
     make CONNECT_TYPE=GAMERNIUM
 
□ Supported disk images
  (1) SCSI hard disk
    HDS file format (extension HDS/HDN/HDI/NHD/HDA)
    The file size can be any size within the range of 10MB to 4095MB (in 512-byte units)

    If the extension is "HDN", a genuine hard disk for NEC genuine 55 board (PC-9801-55)
    Perform emulation. There is a difference in information returned by INQUIRY and MODE SENSE size.

    If the extension is "HDI" or "NHD", the PC98 emulator is Annex86 or T98Next.
    It is intended to use a SCSI hard disk image. Some information as in HDN
    is converted for NEC.

    If the extension is "HDA", APPLE genuine hard disk emulation is performed.
    There is a difference in the information returned by INQUIRY and MODE SENSE.

  (2) SASI hard disk
    HDF file format (extension HDF)
    File size is either 10441728 bytes, 20748288 bytes, or 41496576 bytes
    We recommend 10MB drive, 20MB drive and 40MB drive respectively.
    Any file size from 10M to 512M can be mounted in 256-byte units.

    Images from version 1.46 to 22437888 bytes are for MZ-2500/MZ-2800 MZ-1F23
    Recognized as a 20MB image (special image with a block size of 1024).

  (3) SCSI magneto-optical (MO) disk
    MOS file format (extension MOS)
    File size is one of the following four types:
      128MB type (127398912 bytes)
      230MB type (228518400 bytes)
      540MB type (533248000 bytes)
      640MB type (635600896 bytes)
    128MB, 230MB, 540MB is 512 bytes/sector and 640MB is 2048 bytes/sector.

  (4) SCSI CD-ROM disk
     ISO file format (extension ISO, ISO9660 solid image)
     Record in a file containing only data and in RAW format in mode 1 (2048 bytes/sector)
     Both files are supported.

□ Disk image creation
  RaSCSI is a derivative of the XM6 TypeG, an X68000 emulator. 
  It is assumed that the disk image is created from the "Tools" menu of XM6 TypeG.
  Of course, you can also create an empty image file with dd according to the specifications explained above.

  Example) When creating a 100 MB HDS image (empty file)

    dd if=/dev/zero of=HARDDISK.HDS bs=512 count=204800

□ Operation record
  The author's development environment X68000 PRO (built-in SASI/genuine SCSI board), X68030 built-in SCSI,
  We have confirmed the operation with the XVI Compact built-in SCSI. It also worked on Mach-2.

  Since there were other operation reports on the first generation X68000, ACE, EXPERT, XVI, PRO2, SUPER, etc.,
  The X68000 series should be fine.

  For other retro PCs, FM TOWNS series, Apple Macintosh, MSX (using MEGA-SCSI)
  There are many reports that the PC98 series worked, but some SCSI boards do not work at all.

□ How to use
　If you are using an X68000 emulator such as XM6, the HDD is built by the emulator.
  You can transfer files to the X68000 machine by copying an image to the Raspberry Pi sd card using ftp.
  The reverse is also true in that files can be placed on the sd card by the host machine and ftp'd from
  the sd card to another machine.

□ License
  RaSCSI is software distributed as is "AS IS".
  
  That is, we do not take any responsibility for any damages that the user receives.
  We are not responsible for fixing any defects or defects in the software.

  There is a risk that the Raspberry Pi and retro PC will break down by using RaSCSI.
  Please use at your own risk.

  This software appears to derive from something called an XM6 TypeG. someone somewhere
  might care if we start to get rich from this software. This is about to go through a
  complete rewrite so...

□About distribution of conversion boards
  If you want to distribute the conversion board for a fee, it is not necessary to obtain permission from the author as long as you follow the conditions below.
  There are none. The author just wants you to be a good netizen and provide enough information to make this project useful to the users.
  It is important to provide sufficient information to the user who purchases the board.

  1.Distribution price - don't get rich from other's work
    Board production cost + parts cost + transportation cost + (general social convention) fee.

  2. Schematic
    Please provide the buyer with the schematic. Simultaneously with board distribution or separately from homepage
    There are no restrictions on the means of downloading. See WIKI for schematics.

  3. Operation verification
    Please verify operation verification on target machines.

□ Public homepage
  http://retropc.net/gimons/rascsi/
  https://github.com/akuker/RASCSI/
  https://discord.com/channels/749261651978748014/749261651978748018

□ Contact information
  see discord above

[EOF]
